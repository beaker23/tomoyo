# This file contains rewriting rules used by ccs-patternize command.

# Domain policy consists with domain declaration lines (which start with
# '<' ,) and acl declaration lines (which do not start with '<' ).
# You can refer the former using 'domain' keyword and the latter using 'acl'
# keyword.
#
# Words in each line are separated by a space character. Therefore, you can
# use 'domain[index]', 'acl[index]' for referring index'th word of the line.
# The index starts from 1, and 0 refers the whole line (i.e.
# 'domain[0]' = 'domain', 'acl[0]' = 'acl').
#
# Three operators are provided for conditional rewriting.
# '.contains' is for 'fgrep keyword' match.
# '.equals' is for 'grep ^keyword$' match.
# '.starts' is for 'grep ^keyword' match.
#
# Rewriting rules are defined using multi-lined chunks. A chunk is terminated
# by a 'rewrite' line which specifies old pattern and new pattern.
# A 'rewrite' line is evaluated only when all preceding 'domain' and 'acl'
# lines in that chunk have matched.
# Evaluation stops at first 'rewrite' line where a word matched old pattern.
# Therefore, no words are rewritten more than once.
#
# For user's convenience, new pattern can be omitted if old pattern is reused
# for new pattern.

# Please use TOMOYO Linux's escape rule (e.g. '\040' rather than '\ ' for
# representing a ' ' in a word).


################
#
# Files Section
#
################

## Files on proc filesystem.

rewrite path_pattern proc:/self/task/\$/fdinfo/\$
rewrite path_pattern proc:/self/task/\$/fd/\$
rewrite head_pattern proc:/self/task/\$/
rewrite path_pattern proc:/self/fdinfo/\$
rewrite path_pattern proc:/self/fd/\$
rewrite head_pattern proc:/self/
rewrite path_pattern proc:/\$/task/\$/fdinfo/\$
rewrite path_pattern proc:/\$/task/\$/fd/\$
rewrite head_pattern proc:/\$/task/\$/
rewrite path_pattern proc:/\$/fdinfo/\$
rewrite path_pattern proc:/\$/fd/\$
rewrite head_pattern proc:/\$/

## Files on devpts filesystem.

rewrite path_pattern devpts:/\$

## Files on pipe filesystem.

rewrite path_pattern pipe:[\$]
rewrite path_pattern pipefs:/[\$]

## Files on / partition.

rewrite tail_pattern /etc/shadow\?
rewrite tail_pattern /etc/passwd\?
rewrite tail_pattern /etc/group\?
rewrite tail_pattern /etc/gshadow\?
rewrite tail_pattern /etc/mtab~\$
rewrite tail_pattern /etc/ccs/policy/\*/domain_policy.conf
rewrite tail_pattern /etc/ccs/policy/\*/exception_policy.conf
rewrite tail_pattern /etc/ccs/policy/\*/manager.conf
rewrite tail_pattern /etc/ccs/policy/\*/profile.conf
rewrite tail_pattern /etc/ccs/policy/\*/
rewrite tail_pattern /etc/cups/printers.conf.\+
rewrite tail_pattern /etc/cups/subscriptions.conf.\+
rewrite tail_pattern /etc/.#localtime\*
rewrite head_pattern /.Trash-\+\+\+\+/

# Files on /dev/shm

#rewrite tail_pattern /dev/shm/.org.chromium.Chromium.\*

# Files on /dev

rewrite path_pattern /dev/bus/usb/\+\+\+/\+\+\+
rewrite tail_pattern /dev/disk/by-id/usb-\*
rewrite tail_pattern /dev/disk/by-path/pci-\*
rewrite tail_pattern /dev/disk/by-label/\*
rewrite tail_pattern /dev/disk/by-uuid/\*
rewrite tail_pattern /dev/disk/by-partuuid/\*
rewrite tail_pattern /dev/snd/control\a\+
rewrite tail_pattern /dev/hidraw\+
rewrite tail_pattern /dev/input/by-path/pci-\*
rewrite tail_pattern /dev/input/by-path/usb-\*
rewrite tail_pattern /dev/input/by-id/usb-\*
rewrite tail_pattern /dev/input/event\+\+
rewrite tail_pattern /dev/input/event\+
rewrite tail_pattern /dev/usbfd\+
rewrite tail_pattern /dev/snd/by-id/\*
rewrite tail_pattern /dev/snd/by-path/\*
rewrite tail_pattern /dev/sr\+
rewrite tail_pattern /dev/sd\a\+
rewrite tail_pattern /dev/sd\a
rewrite tail_pattern /dev/sg\+
rewrite tail_pattern /dev/usb/lp\+

rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/char/\+:\+

rewrite tail_pattern /dev/char/\+\+\+:\+\+\+
rewrite tail_pattern /dev/char/\+\+\+:\+\+
rewrite tail_pattern /dev/char/\+\+\+:\+
rewrite tail_pattern /dev/char/\+\+:\+\+
rewrite tail_pattern /dev/char/\+\+:\+
rewrite tail_pattern /dev/char/\+:\+\+
rewrite tail_pattern /dev/char/\+:\+

rewrite tail_pattern /dev/block/\+\+\+:\+\+\+
rewrite tail_pattern /dev/block/\+\+\+:\+\+
rewrite tail_pattern /dev/block/\+\+\+:\+
rewrite tail_pattern /dev/block/\+\+:\+\+
rewrite tail_pattern /dev/block/\+\+:\+
rewrite tail_pattern /dev/block/\+:\+\+
rewrite tail_pattern /dev/block/\+:\+

# rewrite tail_pattern /dev/input/by-uuid/\*
# rewrite tail_pattern /dev/input/by-label/\*
# rewrite tail_pattern /dev/dri/card\+

# /dev/shm/

rewrite tail_pattern /dev/shm/suspscan.\+\+\+\+\+.strings
rewrite tail_pattern /dev/shm/.org.chromium.Chromium.\?\?\?\?\?\?
rewrite tail_pattern /dev/shm/DzlCounters-\$

## Files on /newroot

rewrite tail_pattern /newroot/tmp/\*

## Files on /oldroot

rewrite tail_pattern /oldroot/usr/share/gnome-documents/getting-started/\a/\*

rewrite head_pattern /oldroot/tmp/gnome-desktop-thumbnailer-\?\?\?\?\?\?/

## Files on /run partition.

# /run/cups

rewrite tail_pattern /run/cups/certs/\$
rewrite tail_pattern /run/cups/certs/\?

# /run/dhcpcd

rewrite path_pattern /run/dhcpcd-eth\+.pid
rewrite path_pattern /run/dhcpcd-eth\+.sock
rewrite path_pattern /run/dhcpcd-usb\+.pid
rewrite path_pattern /run/dhcpcd-usb\+.sock
rewrite path_pattern /run/dhcpcd-wlan\+.pid
rewrite path_pattern /run/dhcpcd-wlan\+.sock

# /run/disks

rewrite path_pattern /run/udisks\+/mounted-fs.\?\?\?\?\?\?

# /run/firejail

rewrite tail_pattern /run/firejail/name/\$
rewrite tail_pattern /run/firejail/profile/\$

# /run/mount

rewrite tail_pattern /run/mount/utab.\?\?\?\?\?\?

# /run/systemd

rewrite tail_pattern /run/systemd/inhibit/.#\?\?\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/inhibit/.#\?\?\?\?\?\?\?

rewrite tail_pattern /run/systemd/journal/streams/.#\+:\+\+\+\+\+\+\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/journal/streams/.#\?:\?\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/journal/streams/\+:\+\+\+\+\+\+
rewrite tail_pattern /run/systemd/journal/streams/\?:\?\?\?\?\?
rewrite tail_pattern /run/systemd/sessions/.#\?\?\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/sessions/.#\?\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/units/.#invocation:systemd-\@.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/invocation:systemd-\@.service
rewrite tail_pattern /run/systemd/units/.#invocation:accounts-daemon.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:geoclue.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:geoclue.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:polkit.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:rtkit-daemon.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:session-\+.scope\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:sys-fs-fuse-connections.mount\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:udisks2.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:upower.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x
rewrite tail_pattern /run/systemd/units/.#invocation:wpa_supplicant.service\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x\x

rewrite tail_pattern /run/systemd/users/.#1000\?\?\?\?\?\?
rewrite tail_pattern /run/systemd/inhibit/\+\+.ref
rewrite tail_pattern /run/systemd/inhibit/\+\+
rewrite path_pattern /run/systemd/inhibit/\+.ref
rewrite tail_pattern /run/systemd/inhibit/\+

# /run/udev

rewrite tail_pattern /run/udev/data/.#+module:fuse\?\?\?\?\?\?
rewrite tail_pattern /run/udev/data/.#+backlight:acpi_video\?\?\?\?\?\?\?
rewrite tail_pattern /run/udev/data/+backlight:acpi_video\?
rewrite path_pattern /run/udev/data/+drm:card\?-DP-\?
rewrite path_pattern /run/udev/data/+drm:card\?-HDMI-\?-\?
rewrite tail_pattern /run/udev/data/+sound:card\?
rewrite tail_pattern /run/udev/data/.#+hid:\*
rewrite tail_pattern /run/udev/data/.#+input:\*
rewrite tail_pattern /run/udev/data/.#+leds:\*
rewrite tail_pattern /run/udev/data/.#+usb:\*
rewrite tail_pattern /run/udev/data/.#+sound:\*
rewrite tail_pattern /run/udev/data/+sound:\*
rewrite tail_pattern /run/udev/data/+hid:\*
rewrite tail_pattern /run/udev/data/+usb:\*
rewrite tail_pattern /run/udev/data/+input:\*
rewrite tail_pattern /run/udev/data/+leds:\*
rewrite tail_pattern /run/udev/data/.#\a\*
rewrite tail_pattern /run/udev/data/\a\*

rewrite path_pattern /run/udev/links/\\x2finput\\x2fby-id\\x2fusb-\*/\a\*
rewrite head_pattern /run/udev/links/\\x2finput\\x2fby-id\\x2fusb-\*/
rewrite path_pattern /run/udev/links/\\x2fdisk\\x2fby-partuuid\\x2f\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdisk\\x2fby-partuuid\\x2f\*/
rewrite path_pattern /run/udev/links/\\x2fdri\\x2fby-path\\x2fpci-\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdri\\x2fby-path\\x2fpci-\*/
rewrite path_pattern /run/udev/links/\\x2fsnd\\x2fby-id\\x2fusb-\*/\a\*
rewrite path_pattern /run/udev/links/\\x2fsnd\\x2fby-path\\x2fpci-\*/\a\*
rewrite path_pattern /run/udev/links/\\x2finput\\x2fby-path\\x2fpci\*/\a\*
rewrite head_pattern /run/udev/links/\\x2finput\\x2fby-path\\x2fpci\*/
rewrite path_pattern /run/udev/links/\\x2fdisk\\x2fby-id\\x2fusb\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdisk\\x2fby-id\\x2fusb\*/
rewrite path_pattern /run/udev/links/\\x2fdisk\\x2fby-path\\x2f\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdisk\\x2fby-path\\x2f\*/
rewrite path_pattern /run/udev/links/\\x2fdisk\\x2fby-label\\x2f\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdisk\\x2fby-label\\x2f\*/
rewrite path_pattern /run/udev/links/\\x2fdisk\\x2fby-uuid\\x2f\*/\a\*
rewrite head_pattern /run/udev/links/\\x2fdisk\\x2fby-uuid\\x2f\*/
rewrite tail_pattern /run/udev/links/\\x2fblu-ray0/\a\*
rewrite head_pattern /run/udev/links/\\x2fblu-ray0/
rewrite path_pattern /run/udev/links/\\x2fcdrom/\a\*
rewrite path_pattern /run/udev/links/\\x2fusbfd/\a\*
rewrite head_pattern /run/udev/links/\\x2fusbfd/
rewrite path_pattern /run/udev/links/\\x2fusbfd\+/\a\*
rewrite head_pattern /run/udev/links/\\x2fusbfd\+/

rewrite tail_pattern /run/udev/tags/power-switch/\a\*
rewrite tail_pattern /run/udev/tags/seat/+input:\*
rewrite tail_pattern /run/udev/tags/seat/\a\*
rewrite tail_pattern /run/udev/tags/systemd/\a\*
rewrite tail_pattern /run/udev/tags/uaccess/\a\*

rewrite tail_pattern /run/udev/watch/\?\?
rewrite tail_pattern /run/udev/watch/\?

rewrite path_pattern /run/udisks\+/mounted-fs

# /run/user

# Consider not using the following commented entry to prevent reducing the security of the system.
# 
# rewrite tail_pattern /run/user/<uid>/\*
#

rewrite path_pattern /run/user/1000/.\?\?\?\?\?\?/s
rewrite head_pattern /run/user/1000/.\?\?\?\?\?\?/

rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?\?.\+.slave-socket
rewrite tail_pattern /run/user/1000/\?.\+\+.slave-socket
rewrite tail_pattern /run/user/1000/\?.\+.slave-socket

rewrite tail_pattern /run/user/1000/wayland-cursor-shared-\?\?\?\?\?\?
rewrite tail_pattern /run/user/1000/wayland-cursor-shared\?\?\?\?\?\?
rewrite tail_pattern /run/user/1000/xwayland-shared-\?\?\?\?\?\?
rewrite tail_pattern /run/user/1000/#\?\?\?\?\?\?
rewrite tail_pattern /run/user/1000/#\?\?\?\?\?

## Files on /tmp/ partition.

# Consider not using the following commented entries to prevent reducing the security of the system.
# 
# rewrite path_pattern /tmp/\{\*\}/\*
# rewrite head_pattern /tmp/\{\*\}/
# rewrite tail_pattern /tmp/\*
#

rewrite tail_pattern /vte\?\?\?\?\?\?
rewrite tail_pattern /.ICE-unix/\$
rewrite tail_pattern /keyring-\?\?\?\?\?\?/socket.ssh
rewrite tail_pattern /orbit-\*/bonobo-activation-register-\X.lock
rewrite tail_pattern /orbit-\*/bonobo-activation-server-\X-ior
rewrite tail_pattern /orbit-\*/linc-\*
rewrite tail_pattern /orbit-\*/
rewrite tail_pattern /sh-thd-\$
rewrite tail_pattern /zman\?\?\?\?\?\?

rewrite path_pattern /tmp/gnome-desktop-thumbnailer-\?\?\?\?\?\?/\*
rewrite head_pattern /tmp/gnome-desktop-thumbnailer-\?\?\?\?\?\?/

rewrite head_pattern /tmp/systemd-private-\@.service-\?\?\?\?\?\?/tmp/
rewrite head_pattern /tmp/systemd-private-\@.service-\?\?\?\?\?\?/

rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/fd
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/full
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/hugepages/
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/log
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/mqueue/
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/null
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/ptmx
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/pts/
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/random
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/shm/
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/stderr
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/stdin
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/stdout
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/tty
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/urandom
rewrite path_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/zero
rewrite head_pattern /tmp/namespace-dev-\?\?\?\?\?\?/dev/
rewrite head_pattern /tmp/namespace-dev-\?\?\?\?\?\?/
rewrite path_pattern /tmp/.org.chromium.Chromium.\?\?\?\?\?\?/SingletonSocket
rewrite path_pattern /tmp/.org.chromium.Chromium.\?\?\?\?\?\?/SingletonCookie

rewrite tail_pattern /tmp/xsane-conversion-hpaio:\*
rewrite path_pattern /tmp/xsane-preview-level-\+-hpaio:\*
rewrite tail_pattern /tmp/xsane-viewer-hpaio:\*

rewrite path_pattern /tmp/\?\?\?\?\?\?\?\?\?\?.tmp/\?\?\?\?\?\?\?\?\?\?.tmp
rewrite path_pattern /tmp/.\?\?\?\?\?\?/\?

rewrite head_pattern /tmp/.org.chromium.Chromium.\?\?\?\?\?\?/
rewrite head_pattern /tmp/\?\?\?\?\?\?\?\?\?\?.tmp/
rewrite head_pattern /tmp/.\?\?\?\?\?\?/

rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?.\?\?\?\?\?\?
rewrite tail_pattern /tmp/.\?\?\?\?\?\?
rewrite tail_pattern /tmp/.\?\?\?\?\?
rewrite tail_pattern /tmp/#\?\?\?\?\?\?
rewrite tail_pattern /tmp/#\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?
rewrite tail_pattern /tmp/\?\?\?\?\?\?\?\?\?\?\?\?\?

## Files on /usr

rewrite tail_pattern /usr/share/fonts/util/\*
rewrite tail_pattern /usr/share/fonts/encodings/large/\*

## Files on /var/ partition.

rewrite tail_pattern /var/cache/cups/job.cache.\*
rewrite tail_pattern /var/cache/fontconfig/\*

rewrite tail_pattern /var/cache/man/\*/index.db.\?\?\?\?\?\?
rewrite tail_pattern /var/cache/man/\*/\$
rewrite tail_pattern /var/cache/man/index.db.\?\?\?\?\?\?
rewrite tail_pattern /var/cache/man/\$

# /var/lib/

rewrite tail_pattern /var/lib/systemd/coredump/core.\*
rewrite tail_pattern /var/lib/systemd/coredump/#\?\?\?\?\?\?

rewrite tail_pattern /var/lib/rkhunter/tmp/lsofprocs.out.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/modslist.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/rkh_prop_list.new.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/rkh_prop_list.new.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/rkhunter.dat.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/suckitexttest.\?\?\?\?\?\?\?\?\?\?.mem
rewrite tail_pattern /var/lib/rkhunter/tmp/suckitexttest.\?\?\?\?\?\?\?\?\?\?.xrk
rewrite tail_pattern /var/lib/rkhunter/tmp/suckitexttest.\?\?\?\?\?\?\?\?\?\?
rewrite tail_pattern /var/lib/rkhunter/tmp/suspscan.tmp.\?\?\?\?\?\?\?\?\?\?


# /var/log/

rewrite path_pattern /var/log/journal/\X/user-1000@\@.journal
rewrite path_pattern /var/log/journal/\X/user-1000.journal
rewrite path_pattern /var/log/journal/\X/system@\@.journal
rewrite path_pattern /var/log/journal/\X/system.journal
rewrite tail_pattern /var/log/tomoyo/\*

# /var/spool

rewrite tail_pattern /var/spool/cups/tmp/gs_\?\?\?\?\?\?
rewrite tail_pattern /var/spool/cups/\*

# /var/tmp/

rewrite head_pattern /var/tmp/systemd-private-\@.service-\?\?\?\?\?\?/tmp/
rewrite head_pattern /var/tmp/systemd-private-\@.service-\?\?\?\?\?\?/

###############################
#
# Files on the /sys/ partition.
#
###############################

## /sys/devices/
##
## The following entries are made in order to allow moving USB devices from one USB port to another.
## Typically it is not necessary or may be undesirable to patternize entries for hardware devices
## which always have the same location on the filesystem. Such entries reduce the security of the system.
## With the pathname-based MAC provided by TOMOYO the more specific the path, the greater the security.
## 
## Applications, additionally, access these devices by other means such as through the /dev/bus/usb/ section above.
#
# If it is desired to limit access to a specific USB port, such as if a USB flash drive is always plugged into
# the same USB port, and no other devices are ever used from this port an entry such as the following could
# be used to restrict access to this device from other applications, while still allowing us to increase usability
# and move other devices from one port to another:
#
# rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/\*\-1-5/\{\*\}/\*
# rewrite head_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/\*\-1-5/\{\*\}/
# rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/\*\-1-5/\*
#
# The entry in the above example would patternize access to any usb ports with the /sys/devices/pci0000:00/0000:00:14.0/usb1/
# path on the filesystem while protecting the port at /sys/devices/pci0000:00/0000:00:14.0/usb1/1-5/ by limiting access to it
# strictly for applications that require access to this port.
#
# Another method to add this type of protection is to use USBGuard to provide this type of protection. The proteciton added
# by TOMOYO is capable of working in addition to any protection added by USBGuard by adding another layer that re-enforces the protection
# created by USBGuard once domain policy generation is complete and enforcing.
#
# Note how TOMOYO's subtraction operator "\-" is used in the above example, this helps ensure that we limit access to the protected
# USB port, while allowing us to still increase usabiliity of the system and simplify the creation of domain policy.
#
# If it is desired to patternize access to the protected USB port to simplify domain policy generation a pattern similar to the
# following could be used.
#
# rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/1-5/\{\*\}/\*
# rewrite head_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/1-5/\{\*\}/
# rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb1/1-5/\*
#
# It is important to note that the above example would patternize granting access to the protected USB port, and while it may simplify
# administration and domain policy generation it also reduces the security of the protected port. Since this port is a hardware device
# associated with a specific physical USB port, it should always reside on the filesystem at the same location and the above pattern
# would grant applications that access this port greater access to the device than they may need to perform their functions.
#
# To identify the correct location on the filesystem lspci, ls, or other methods may be used to identify the specific location
# of the physical USB port that is to be afforded more protected.
#
# The following entries have been selected to attempt to provide both security and usability for the USB buses.
# There are a large number of entries in an attempt to provide a higher degree of granularity for the MAC system.
# If using them you will need to enter the appropriate fields for your <pci bus> and any protected USB ports.
#
# No entries have been entered to patternize access to the protected USB port to ensure the maximum amount of security on this port.
# Instead entries have been made that limit access to this USB port.
# 

rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/id
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/number
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/pcm_class
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/direction
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/capabilities/sw
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/sd\a\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/sd\a\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/sd\a\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/sd\a/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/sdb\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/sdb\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/sdb\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/block/s\a\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bNumEndpoints
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bInterfaceSubClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/removable
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/model
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/rev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/type
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/vendor
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/speed
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bInterfaceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bDeviceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bcdDevice
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/busnum
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/devnum
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/idProduct
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/idVendor
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bConfigurationValue
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/descriptors
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/manufacturer
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/product
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/serial
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/uevent
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/abs
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/ev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/key
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/rel
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bustype
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/name
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/phys
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/properties
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/bInterfaceNumber
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\{\*\}/scsi_level

rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/id
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/number
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/pcm_class
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/direction
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/capabilities/sw
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/sd\a\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/sd\a\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/sd\a\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/sd\a/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/sdb\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/sdb\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/sdb\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/block/sd\a/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bNumEndpoints
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/scsi_level
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bInterfaceSubClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/removable
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/model
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/rev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/type
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/vendor
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/speed
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bConfigurationValue
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/descriptors
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/manufacturer
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/product
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/uevent
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bInterfaceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bDeviceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/bcdDevice      
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/busnum         
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/devnum         
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/idProduct      
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/idVendor       
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*\-1-2/\*/serial

rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/id
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/number
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/pcm_class
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/direction
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/capabilities/sw
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/sd\a\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/sd\a\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/sd\a\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/sd\a/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/queue/rotational
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/sdb\+/ro
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/sdb\+/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/sdb\+/start
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/block/sd\a/size
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bNumEndpoints
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/scsi_level
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bInterfaceSubClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/removable
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/model
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/rev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/type
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/vendor
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/speed
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bConfigurationValue
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/descriptors
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/manufacturer
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/product
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/uevent
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bInterfaceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bDeviceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/bcdDevice      
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/busnum         
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/devnum         
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/idProduct      
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/idVendor       
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/\*/serial

rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/authorized
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/authorized_default
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/avoid_reset_quirk
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bcdDevice
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bConfigurationValue
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bDeviceClass
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bDeviceProtocol
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bmAttributes
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bMaxPacketSize\+
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bMaxPower
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bNumConfigurations
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/bNumInterfaces
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/busnum
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/configuration
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/descriptors
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/dev
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/devnum
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/devpath
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/devspec
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/idProduct
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/idVendor
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/interface_authorized_default
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/ltm_capable
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/manufacturer
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/maxchild
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/product
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/quirks
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/removable
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/remove
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/rx_lanes
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/serial
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/speed
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/tx_lanes
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/uevent
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/urbnum
rewrite path_pattern /sys/devices/pci0000:00/0000:00:14.0/usb\+/version



# /sys/devices/platform/

rewrite path_pattern /sys/devices/platform/regulatory.\+/uevent

# /sys/devices/virtual/

rewrite path_pattern /sys/devices/virtual/bdi/\*/uevent

## /sys/fs/

## These entries are limited to specific paths in order to protect the /sys/fs/ partition.
## Minimal entries are made for usability.

# Network Section
# 
# To make use of the network entries pass "net.ifnames=0" as a kernel command line option at boot.

rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/
rewrite path_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/cgroup.events
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@eth\+.service/

rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/
rewrite path_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/cgroup.events
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@usb\+.service/

rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/
rewrite path_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/cgroup.events
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-dhcpcd.slice/dhcpcd@wlan\+.service/

## Video Section

rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dbacklight.slice/systemd-backlight@backlight:acpi_video\+.service/

## Disk Section

rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2d\@.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2d\@.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2duuid-\@.service/cgroup.procs


rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2duuid-\@.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2duuid-\@.service/
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2duuid-\@.service/
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-systemd\\x2dfsck.slice/systemd-fsck@dev-disk-by\\x2duuid-\@.service/

## Kernel Section

rewrite path_pattern /sys/fs/cgroup/devices/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/devices/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/devices.allow
rewrite path_pattern /sys/fs/cgroup/devices/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/devices.deny
rewrite head_pattern /sys/fs/cgroup/devices/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/
rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@-0.service/memory.limit_in_bytes
rewrite head_pattern /sys/fs/cgroup/memory/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.procs
rewrite path_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/pids.max
rewrite head_pattern /sys/fs/cgroup/pids/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/
rewrite path_pattern /sys/fs/cgroup/systemd/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/systemd/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.events
rewrite path_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/cgroup.procs
rewrite head_pattern /sys/fs/cgroup/unified/system.slice/system-systemd\\x2dcoredump.slice/systemd-coredump@\@.service/

###################################
#
# Files on /home/<user>/ partition.
#
###################################

## To make use of the examples provided replace <user> with your username.

## Limit Access to Home directories for Chromium
## Accomplished by manually ensuring Chromium only has access to this path on /home/<user>/<named>/ in domain policy.

rewrite tail_pattern /home/<user>/Downloads/\*

## Limit Access to a named directory on the /home/<user>/ partition.
## 
## Accomplished by manually ensuring other applications do not gain access to /home/<user>/<named>/ in domain policy.
## Additionally, this named directory should be excluded from any path groups that are subsequently created.

rewrite tail_pattern /home/<user>/Keepass/\*

## Home Path Groups
##
## These groups are used to maintain usability of the system, and ease administration of domain policy, while
## at the same time compartmentalizing access permissions on the /home/<user>/ partition.

# The following path groups provide access to the named /home/<user>/<name>/ directories and all sub-directories and files.
# They may be combined in a single path group named @HOME, or any other name you choose.
#
# Adding these entries into the patternize.conf allows these policies to be implemented while using
# TOMOYO's learning mode, and while patternizing policy and loading it into domain policy from logs
# or other sources.
#
# Creating rules as such greatly enhances the speed with which TOMOYO learns domain policy, and eases administration.
#
# An alternative to this method is to use TOMOYO's ACLs, which this patternize.conf not make use of on the filesystem.
# These path groups could also be used in conjunction with ACLs depending on how you choose to administer your system.
#
# Corresponding entries should be added to the domain exception policy in the form of:
#
# path_group HOME /home/<user>/<named>/\*
# path_group HOME /home/<user>/<named>/\{\*\}/
# path_group HOME /home/<user>/<named>/\{\*\}/\*
#
# An example entry for the patternize.conf to allow this entry for user bob's Documents, and Pictures directories are as follows:
#
# rewrite path_pattern /home/bob/Documents/\{\*\}/\* @HOME
# rewrite head_pattern /home/bob/Documents/\{\*\}/ @HOME
# rewrite tail_pattern /home/bob/Documents/\* @HOME
#
# rewrite path_pattern /home/bob/Pictures/\{\*\}/\* @HOME
# rewrite head_pattern /home/bob/Pictures/\{\*\}/ @HOME
# rewrite tail_pattern /home/bob/Pictures/\* @HOME

rewrite path_pattern /home/<user>/Desktop/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Desktop/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Desktop/\* @HOME

rewrite path_pattern /home/<user>/Documents/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Documents/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Documents/\* @HOME

rewrite path_pattern /home/<user>/Downloads/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Downloads/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Downloads/\* @HOME

rewrite path_pattern /home/<user>/mnt/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/mnt/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/mnt/\* @HOME

rewrite path_pattern /home/<user>/Music/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Music/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Music/\* @HOME

rewrite path_pattern /home/<user>/Pictures/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Pictures/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Pictures/\* @HOME

rewrite path_pattern /home/<user>/Public/\{\*\}/\* @HOME-PUBLIC
rewrite head_pattern /home/<user>/Public/\{\*\}/ @HOME-PUBLIC
rewrite tail_pattern /home/<user>/Public/\* @HOME-PUBLIC

rewrite path_pattern /home/<user>/share/\{\*\}/\* @SHARE-ACCESS
rewrite head_pattern /home/<user>/share/\{\*\}/ @SHARE-ACCESS
rewrite tail_pattern /home/<user>/share/\* @SHARE-ACCESS

rewrite path_pattern /home/<user>/Templates/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Templates/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Templates/\* @HOME

rewrite path_pattern /home/<user>/Videos/\{\*\}/\* @HOME
rewrite head_pattern /home/<user>/Videos/\{\*\}/ @HOME
rewrite tail_pattern /home/<user>/Videos/\* @HOME

## The following path groups provide access to hidden directories on /home/<user/ partition.

# /home/<user>/.cache path groups

# /home/<user>/.cache/<named>/ path groups limits applications from accessing <named> cache directories
# to only those that require this access for applications the admin wishes to protect.
#
# This additionally provides the ability to identify all applications that have or try
# to access these named directories cache files once TOMOYO is set to permissive or enforcing for the
# respective domains when used together with the ccs-auditd service or by manually checking policy.
#
# Placing these patterns in this configuration file allows automation of creating these groups while
# developing policy in TOMOYO's learning mode.
#
# These path groups should additionally be added to the domain exception policy in the form of the example
# provided where each line represents a single entry in the domain exception policy.
#
# The example is given for user alice's Chromium cache, and is as follows for the domain exception policy:
#
# path_group CHROME-CACHE /home/alice/.cache/chromium/
# path_group CHROME-CACHE /home/alice/.cache/chromium/\*
# path_group CHROME-CACHE /home/alice/.cache/chromium/\{\*\}/
# path_group CHROME-CACHE /home/alice/.cache/chromium/\{\*\}/\*
#
# Note that domain exception policy is not entered in the patternize.conf file, and is here for reference only.
# These entries may be entered using ccs-editpolicy in the domain exception policy editor or by editing the
# exception_policy.conf file.
#
# An example for the patternize.conf entry for alice's Chromium cache is as follows:
#
# rewrite path_pattern /home/alice/.cache/chromium/\{\*\}/\* @CHROME-CACHE
# rewrite head_pattern /home/alice/.cache/chromium/\{\*\}/ @CHROME-CACHE
# rewrite tail_pattern /home/alice/.cache/chromium/\* @CHROME-CACHE

rewrite path_pattern /home/<user>/.cache/chromium/\{\*\}/\* @CHROME-CACHE
rewrite head_pattern /home/<user>/.cache/chromium/\{\*\}/ @CHROME-CACHE
rewrite tail_pattern /home/<user>/.cache/chromium/\* @CHROME-CACHE

# The following rules are used to further protect any named directories cache files from other applications
# this is accomplished by using TOMOYO's "\-" operator to substract this directory from the access permissions
# that are granted using this pattern.
#
# The corresponding domain exception policy rules are as follows for a single protected directory for user alice:
#
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium/
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium/\*
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium/\{\*\}/
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium/\{\*\}/\*
#
# For multiple directories the following can be used where nameddir is the additional directory to protect:
#
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium\-nameddir
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium\-nameddir/
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium\-nameddir/\*
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium\-nameddir/\{\*\}/
# path_group CACHE-ACCESS /home/alice/.cache/\*\-chromium\-nameddir/\{\*\}/\*
#
# An example of the patternize.conf entry for user alice is as follows for a single protected directory:
#
# rewrite path_pattern /home/alice/.cache/\*\-chromium/\{\*\}/\* @CACHE-ACCESS
# rewrite head_pattern /home/alice/.cache/\*\-chromium/\{\*\}/ @CACHE-ACCESS
# rewrite tail_pattern /home/alice/.cache/\*\-chromium/\* @CACHE-ACCESS
# rewrite tail_pattern /home/alice/.cache/\*\-chromium @CACHE-ACCESS
#
# An example of the patternize.conf entry for user alice is as follows to protect multiple directories:
# 
# rewrite path_pattern /home/alice/.config/\*\-chromium\-nameddir/\{\*\}/\* @CONFIG-ACCESS
# rewrite head_pattern /home/alice/.config/\*\-chromium\-nameddir/\{\*\}/ @CONFIG-ACCESS
# rewrite tail_pattern /home/alice/.config/\*\-chromium\-nameddir/\* @CONFIG-ACCESS
# rewrite tail_pattern /home/alice/.config/\*\-chromium\-nameddir @CONFIG-ACCESS

# Files on the /home/<user>/.cache/ directory.

rewrite path_pattern /home/<user>/.cache/chromium/\{\*\}/\* @CHROME-CACHE
rewrite head_pattern /home/<user>/.cache/chromium/\{\*\}/ @CHROME-CACHE
rewrite tail_pattern /home/<user>/.cache/chromium/\* @CHROME-CACHE

rewrite path_pattern /home/<user>/.cache/\*\-chromium/\{\*\}/\* @CACHE-ACCESS
rewrite head_pattern /home/<user>/.cache/\*\-chromium/\{\*\}/ @CACHE-ACCESS
rewrite tail_pattern /home/<user>/.cache/\*\-chromium/\* @CACHE-ACCESS

# /home/<user>/.config/ path groups

# /home/<user>/.config/<named>/ path groups provide the same principle as used above, only
# for use with the /home/<user>/.config/ directory, as do any subsequently listed hidden directories.

rewrite path_pattern /home/<user>/.config/chromium/\{\*\}/\* @CHROME-CONFIG
rewrite head_pattern /home/<user>/.config/chromium/\{\*\}/ @CHROME-CONFIG
rewrite tail_pattern /home/<user>/.config/chromium/\* @CHROME-CONFIG

rewrite path_pattern /home/<user>/.config/keepassxc/\{\*\}/\* @KEE-CONFIG
rewrite head_pattern /home/<user>/.config/keepassxc/\{\*\}/ @KEE-CONFIG
rewrite tail_pattern /home/<user>/.config/keepassxc/\* @KEE-CONFIG

rewrite path_pattern /home/<user>/.config/\*\-chromium\-keepassxc/\{\*\}/\* @CONFIG-ACCESS
rewrite head_pattern /home/<user>/.config/\*\-chromium\-keepassxc/\{\*\}/ @CONFIG-ACCESS
rewrite tail_pattern /home/<user>/.config/\*\-chromium\-keepassxc/\* @CONFIG-ACCESS
rewrite tail_pattern /home/<user>/.config/\*\-chromium\-keepassxc @CONFIG-ACCESS

# /home/<user>/.gnupg/ path groups

rewrite path_pattern /home/<user>/.gnupg/\{\*\}/\* @GPG
rewrite head_pattern /home/<user>/.gnupg/\{\*\}/ @GPG
rewrite tail_pattern /home/<user>/.gnupg/\* @GPG

# /home/<user>/.local/ path groups

rewrite path_pattern /home/<user>/.local/share/\{\*\}/\* @LOCAL-ACCESS
rewrite head_pattern /home/<user>/.local/share/\{\*\}/ @LOCAL-ACCESS
rewrite tail_pattern /home/<user>/.local/share/\* @LOCAL-ACCESS

# Limit Access to /home/<user>/ Directory sometimes temp files appear here.

rewrite tail_pattern /home/<user>/#\?\?\?\?\?\?\?
rewrite tail_pattern /home/<user>/\?\?\?\?\?\?
rewrite tail_pattern /home/<user>/.ICEauthority-\a

# Consider limiting or not using the following commented entries if possible, to prevent reducing
# the security of the system.
#
# rewrite head_pattern /home/<user>/\*/
# rewrite tail_pattern /home/<user>/\*
#
# The following entries would bypass any work accomplished above to protect and limit access to /home/<user>/
#
# rewrite path_pattern /home/<user>/\{\*\}/\*
# rewrite head_pattern /home/<user>/\{\*\}/
# rewrite tail_pattern /home/<user>/\*
#
# The provided examples will aid in creation of domain policy using TOMOYO's learning mode. However, it may still
# be desired to audit the resulting domain policy to ensure applications only have access to parts of the system
# that you want them to have access to.
#
# As an example, application foo may gain access to parts of the system (files) using the learning mode that you do not want
# it to access. With experimentation it may be found that application foo operates just fine for your use case without
# access to those files. Therefore, foo will gain access to files in learning mode that you as an administrator may prevent 
# it from accessing by removing its access to those files you do not wish it to have access to.

##################
#
# Network Section
#
##################

# Chromium Port Access
#domain.equals <kernel> /usr/bin/chromium
#acl.starts network inet stream accept
#rewrite number_pattern 1024-65535 @WEB-PORTS

# Aria2c Port Access
#domain.equals <kernel> /usr/bin/aria2c
#acl.starts network inet
#rewrite number_pattern 6881-6999 @ARIA2C-PORTS
